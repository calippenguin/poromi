<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>포로미의 공간</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="wrapper">
        <div class="tabs-container">
            <button class="tab-button active" onclick="loadTab('profile', this)">프로필</button>
            <button class="tab-button" onclick="loadTab('rules', this)">채팅규칙</button>
            <button class="tab-button" onclick="loadTab('history', this)">활동이력</button>
            <button class="tab-button" onclick="loadTab('games', this)">게임목록</button>
            <button class="tab-button" onclick="loadTab('etc', this)">기타(시그, 별명, 등)</button>
        </div>

        <div id="main-content" class="main-box">
            </div>
    </div>

    <script>
        // 탭을 불러오는 함수
        function loadTab(tabName, element) {
            // 1. 모든 버튼에서 active 클래스 제거
            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(btn => btn.classList.remove('active'));
        
            // 2. 클릭한 버튼에 active 클래스 추가
            element.classList.add('active');
        
            // 3. 파일 가져오기
            fetch(`./tabs/${tabName}.html`)
                .then(response => {
                    if (!response.ok) throw new Error('네트워크 응답 없음');
                    return response.text();
                })
                .then(data => {
                    const container = document.getElementById('main-content');
                    container.innerHTML = data;
        
                    // [핵심!] CSS가 먹히지 않는 현상 방지: 강제 리플로우 유도
                    // 브라우저가 새 HTML을 인식하도록 잠시 숨겼다 보여주는 트릭입니다.
                    container.style.display = 'none';
                    container.offsetHeight; // 읽기 동작으로 강제 계산 유도
                    container.style.display = 'block';
                    
                    console.log(`${tabName} 로드 완료 및 스타일 갱신 시도`);
                })
                .catch(error => {
                    console.error('탭 로딩 에러:', error);
                    document.getElementById('main-content').innerHTML = "<p>내용을 불러오지 못했습니다.</p>";
                });
        }

        // 페이지 처음 로딩 시 '프로필' 탭 자동 실행
        window.onload = () => {
            loadTab('profile', document.querySelector('.tab-button'));
        };

        function openModal(title, description, videoUrl, imageUrl) {
            const modal = document.getElementById('etcModal');
            const vBox = document.getElementById('modalVideoBox');
            const vPlayer = document.getElementById('sigVideo');
            const iBox = document.getElementById('modalImageBox');
            const iDisplay = document.getElementById('sigImage');
        
            document.getElementById('modalTitle').innerText = title;
            document.getElementById('modalDescription').innerText = description;
        
            // 1. 영상 처리
            if (videoUrl) {
                vBox.style.display = 'block';
                vPlayer.src = videoUrl;
            } else {
                vBox.style.display = 'none';
                vPlayer.src = '';
            }
        
            // 2. 이미지 처리 (영상 아래에 추가 이미지를 넣고 싶을 때 사용)
            if (imageUrl) {
                iBox.style.display = 'block';
                iDisplay.src = imageUrl;
            } else {
                iBox.style.display = 'none';
            }
        
            modal.style.display = 'block';
        }
        
    function closeModal() {
        const modal = document.getElementById('etcModal');
        const vPlayer = document.getElementById('sigVideo');
        
        modal.style.display = 'none';
        vPlayer.pause(); // 닫을 때 영상 정지
    }
    
    // 팝업 바깥쪽 클릭 시 닫기
    window.onclick = function(event) {
        const modal = document.getElementById('etcModal');
        if (event.target == modal) closeModal();
    }
    </script>
</body>
</html>
